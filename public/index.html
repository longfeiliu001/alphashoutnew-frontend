<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  
  <!-- åŸºæœ¬ favicon é“¾æ¥ -->
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
  
  <!-- PWA manifest -->
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  
  <!-- Windows ç£è´´é…ç½® -->
  <meta name="msapplication-config" content="%PUBLIC_URL%/browserconfig.xml" />
  
  <!-- åŸºæœ¬ meta æ ‡ç­¾ -->
  <meta name="description" content="Institutional-grade investment analytics for everyone. AI-powered stock analysis, portfolio optimization, and technical analysis tools." />
  <meta name="keywords" content="investment analytics, stock analysis, portfolio optimization, financial analysis, AI trading tools" />
  <meta name="theme-color" content="#003d7a" />
  
  <!-- iOS ç‰¹å®šä¼˜åŒ– -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="ALPHASHOUT">
  <meta name="application-name" content="ALPHASHOUT">
  <meta name="msapplication-TileColor" content="#003d7a">
  <meta name="format-detection" content="telephone=no">
  
  <!-- SEO ä¼˜åŒ– -->
  <meta name="author" content="ALPHASHOUT">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://alphashout.app" />
  
  <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="//alphashout.app">
  <link rel="dns-prefetch" href="//polyfill.io">
  
  <title>ALPHASHOUT - Institutional-Grade Investment Analytics</title>

  <!-- ç«‹å³åŠ è½½æ‰€æœ‰å¿…è¦çš„ Polyfillsï¼ˆiOS Safari å…¼å®¹æ€§ï¼‰ -->
  <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=es2015,es2016,es2017,es2018,es2019,es2020,es2021,Promise,Promise.prototype.finally,Object.assign,Object.entries,Object.values,Object.fromEntries,Array.prototype.includes,Array.prototype.flat,Array.prototype.flatMap,String.prototype.includes,String.prototype.startsWith,String.prototype.endsWith,String.prototype.padStart,String.prototype.padEnd,String.prototype.trimStart,String.prototype.trimEnd,Array.from,Array.of,Array.prototype.find,Array.prototype.findIndex,globalThis,queueMicrotask"></script>
  
  <!-- iOS Safari æ ¸å¿ƒå…¼å®¹æ€§ä¿®å¤ -->
  <script>
    // ========== æ ¸å¿ƒå…¼å®¹æ€§ä¿®å¤ ==========
    (function() {
      'use strict';
      
      // 1. ç¡®ä¿ console å¯¹è±¡å®Œæ•´
      if (!window.console) {
        window.console = {};
      }
      var methods = ['log', 'debug', 'info', 'warn', 'error', 'trace', 'group', 'groupEnd', 'time', 'timeEnd'];
      for (var i = 0; i < methods.length; i++) {
        if (!console[methods[i]]) {
          console[methods[i]] = function() {};
        }
      }
      
      // 2. ä¿®å¤ requestAnimationFrame (iOS è€ç‰ˆæœ¬)
      var vendors = ['webkit', 'moz', 'ms', 'o'];
      for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
        window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
        window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || 
                                     window[vendors[x] + 'CancelRequestAnimationFrame'];
      }
      
      if (!window.requestAnimationFrame) {
        var lastTime = 0;
        window.requestAnimationFrame = function(callback) {
          var currTime = new Date().getTime();
          var timeToCall = Math.max(0, 16 - (currTime - lastTime));
          var id = window.setTimeout(function() { 
            callback(currTime + timeToCall); 
          }, timeToCall);
          lastTime = currTime + timeToCall;
          return id;
        };
      }
      
      if (!window.cancelAnimationFrame) {
        window.cancelAnimationFrame = function(id) {
          clearTimeout(id);
        };
      }
      
      // 3. ä¿®å¤ Object.assign (å¦‚æœ polyfill æ²¡æœ‰åŠ è½½)
      if (typeof Object.assign !== 'function') {
        Object.defineProperty(Object, 'assign', {
          value: function assign(target) {
            if (target === null || target === undefined) {
              throw new TypeError('Cannot convert undefined or null to object');
            }
            var to = Object(target);
            for (var index = 1; index < arguments.length; index++) {
              var nextSource = arguments[index];
              if (nextSource !== null && nextSource !== undefined) {
                for (var nextKey in nextSource) {
                  if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {
                    to[nextKey] = nextSource[nextKey];
                  }
                }
              }
            }
            return to;
          },
          writable: true,
          configurable: true
        });
      }
      
      // 4. ä¿®å¤ Promise (åŸºç¡€å®ç°ï¼Œå¦‚æœéœ€è¦)
      if (typeof Promise === 'undefined') {
        window.Promise = function(executor) {
          var self = this;
          self.status = 'pending';
          self.value = undefined;
          self.reason = undefined;
          self.onFulfilledCallbacks = [];
          self.onRejectedCallbacks = [];
          
          function resolve(value) {
            if (self.status === 'pending') {
              self.status = 'fulfilled';
              self.value = value;
              self.onFulfilledCallbacks.forEach(function(callback) {
                callback(value);
              });
            }
          }
          
          function reject(reason) {
            if (self.status === 'pending') {
              self.status = 'rejected';
              self.reason = reason;
              self.onRejectedCallbacks.forEach(function(callback) {
                callback(reason);
              });
            }
          }
          
          try {
            executor(resolve, reject);
          } catch (e) {
            reject(e);
          }
        };
        
        window.Promise.prototype.then = function(onFulfilled, onRejected) {
          var self = this;
          return new Promise(function(resolve, reject) {
            if (self.status === 'fulfilled') {
              if (typeof onFulfilled === 'function') {
                try {
                  var result = onFulfilled(self.value);
                  resolve(result);
                } catch (e) {
                  reject(e);
                }
              } else {
                resolve(self.value);
              }
            } else if (self.status === 'rejected') {
              if (typeof onRejected === 'function') {
                try {
                  var result = onRejected(self.reason);
                  resolve(result);
                } catch (e) {
                  reject(e);
                }
              } else {
                reject(self.reason);
              }
            } else {
              self.onFulfilledCallbacks.push(function() {
                if (typeof onFulfilled === 'function') {
                  try {
                    var result = onFulfilled(self.value);
                    resolve(result);
                  } catch (e) {
                    reject(e);
                  }
                } else {
                  resolve(self.value);
                }
              });
              self.onRejectedCallbacks.push(function() {
                if (typeof onRejected === 'function') {
                  try {
                    var result = onRejected(self.reason);
                    resolve(result);
                  } catch (e) {
                    reject(e);
                  }
                } else {
                  reject(self.reason);
                }
              });
            }
          });
        };
        
        window.Promise.prototype.catch = function(onRejected) {
          return this.then(null, onRejected);
        };
      }
      
      // 5. ä¿®å¤ globalThis
      if (typeof globalThis === 'undefined') {
        (function() {
          if (typeof self !== 'undefined') {
            self.globalThis = self;
          } else if (typeof window !== 'undefined') {
            window.globalThis = window;
          } else if (typeof global !== 'undefined') {
            global.globalThis = global;
          } else {
            this.globalThis = this;
          }
        })();
      }
      
    })();
    
    // ========== React/JavaScript è¯­æ³•ä¿®å¤ ==========
    (function() {
      var originalAppendChild = document.head.appendChild;
      var originalBodyAppendChild = null;
      
      function transformCode(code) {
        try {
          // ä¿®å¤å¯é€‰é“¾æ“ä½œç¬¦ (?.)
          code = code.replace(/(\w+)\?\./g, function(match, p1) {
            return '(' + p1 + ' != null ? ' + p1 + '.';
          });
          
          // ä¿®å¤ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ (??)
          code = code.replace(/(\w+)\s*\?\?\s*/g, function(match, p1) {
            return '(' + p1 + ' !== null && ' + p1 + ' !== undefined ? ' + p1 + ' : ';
          });
          
          // ä¿®å¤å…¶ä»–å¯èƒ½çš„æ–°è¯­æ³•
          // æ³¨æ„ï¼šè¿™åªæ˜¯åŸºç¡€ä¿®å¤ï¼Œå¤æ‚æƒ…å†µå¯èƒ½éœ€è¦æ›´å®Œæ•´çš„è½¬è¯‘
          
          return code;
        } catch (e) {
          console.error('Code transformation error:', e);
          return code;
        }
      }
      
      function interceptScript(original, parent) {
        return function(element) {
          if (element && element.tagName === 'SCRIPT' && element.src && 
              (element.src.includes('bundle.js') || 
               element.src.includes('main.') || 
               element.src.includes('static/js/') ||
               element.src.includes('chunk'))) {
            
            // å¯¹äºéœ€è¦è½¬æ¢çš„è„šæœ¬
            var xhr = new XMLHttpRequest();
            xhr.open('GET', element.src, false); // åŒæ­¥è¯·æ±‚ï¼ˆä¸æ¨èä½†åœ¨è¿™é‡Œå¿…è¦ï¼‰
            try {
              xhr.send();
              if (xhr.status === 200) {
                var transformedCode = transformCode(xhr.responseText);
                var newScript = document.createElement('script');
                newScript.textContent = transformedCode;
                return original.call(parent, newScript);
              }
            } catch (e) {
              console.error('Script loading error:', e);
            }
          }
          
          return original ? original.call(parent, element) : element;
        };
      }
      
      // æ‹¦æˆª head ä¸­çš„è„šæœ¬
      document.head.appendChild = interceptScript(originalAppendChild, document.head);
      
      // æ‹¦æˆª body ä¸­çš„è„šæœ¬
      if (document.body) {
        originalBodyAppendChild = document.body.appendChild;
        document.body.appendChild = interceptScript(originalBodyAppendChild, document.body);
      } else {
        document.addEventListener('DOMContentLoaded', function() {
          if (document.body) {
            originalBodyAppendChild = document.body.appendChild;
            document.body.appendChild = interceptScript(originalBodyAppendChild, document.body);
          }
        });
      }
    })();
    
    // ========== é”™è¯¯æ•è·å’Œè°ƒè¯• ==========
    (function() {
      var errorCount = 0;
      var maxErrors = 10;
      
      window.addEventListener('error', function(e) {
        errorCount++;
        console.error('Global error #' + errorCount + ':', e.message, 'at', e.filename + ':' + e.lineno + ':' + e.colno);
        
        // åœ¨å¼€å‘ç¯å¢ƒæ˜¾ç¤ºé”™è¯¯
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
          if (errorCount <= maxErrors) {
            var errorDiv = document.getElementById('error-display');
            if (!errorDiv) {
              errorDiv = document.createElement('div');
              errorDiv.id = 'error-display';
              errorDiv.style.cssText = 'position:fixed;bottom:0;left:0;right:0;background:#ff0000;color:white;padding:10px;z-index:99999;font-size:12px;max-height:200px;overflow-y:auto;';
              document.body.appendChild(errorDiv);
            }
            errorDiv.innerHTML += '<div>Error ' + errorCount + ': ' + e.message + ' (' + e.filename + ':' + e.lineno + ')</div>';
          }
        }
        
        // é˜²æ­¢é”™è¯¯ä¼ æ’­
        e.preventDefault();
        return true;
      });
      
      window.addEventListener('unhandledrejection', function(e) {
        console.error('Unhandled promise rejection:', e.reason);
        e.preventDefault();
        return true;
      });
    })();
  </script>
  
  <style>
    /* iOS Safari ä¼˜åŒ–æ ·å¼ */
    * {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }
    
    input, textarea {
      -webkit-user-select: text;
      user-select: text;
    }
    
    html, body {
      height: 100%;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    #root {
      min-height: 100%;
    }
    
    /* åŠ è½½æŒ‡ç¤ºå™¨ */
    #loading-indicator {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 99999;
    }
    
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #003D6D;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .loading-text {
      color: #003D6D;
      font-size: 16px;
      font-weight: 500;
    }
    
    /* é˜²æ­¢ iOS æ©¡çš®ç­‹æ•ˆæœ */
    .ios-scroll-fix {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: auto;
      -webkit-overflow-scrolling: touch;
    }
  </style>
</head>
<body>
  <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
  <div id="loading-indicator">
    <div class="spinner"></div>
    <div class="loading-text">Loading ALPHASHOUT...</div>
    <div style="margin-top: 10px; color: #666; font-size: 12px;">Investment Analytics Platform</div>
  </div>
  
  <noscript>
    <div style="text-align: center; padding: 50px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: white; position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 100000;">
      <h2 style="color: #003D6D;">ğŸ€ ALPHASHOUT</h2>
      <p>JavaScript is required to run this application.</p>
      <p>Please enable JavaScript in Safari:</p>
      <ol style="text-align: left; display: inline-block;">
        <li>Open Settings</li>
        <li>Scroll to Safari</li>
        <li>Tap Advanced</li>
        <li>Enable JavaScript</li>
      </ol>
    </div>
  </noscript>
  
  <div id="root"></div>
  
  <!-- åº”ç”¨åŠ è½½ç›‘æ§å’Œé”™è¯¯æ¢å¤ -->
  <script>
    (function() {
      var checkInterval;
      var checkCount = 0;
      var maxChecks = 100; // 10ç§’è¶…æ—¶ (100 * 100ms)
      
      function hideLoadingIndicator() {
        var indicator = document.getElementById('loading-indicator');
        if (indicator) {
          indicator.style.transition = 'opacity 0.3s';
          indicator.style.opacity = '0';
          setTimeout(function() {
            if (indicator.parentNode) {
              indicator.parentNode.removeChild(indicator);
            }
          }, 300);
        }
      }
      
      function checkAppLoaded() {
        checkCount++;
        var root = document.getElementById('root');
        
        // æ£€æŸ¥åº”ç”¨æ˜¯å¦åŠ è½½
        if (root && root.children.length > 0) {
          clearInterval(checkInterval);
          hideLoadingIndicator();
          console.log('App loaded successfully');
          return;
        }
        
        // è¶…æ—¶å¤„ç†
        if (checkCount >= maxChecks) {
          clearInterval(checkInterval);
          console.error('App loading timeout');
          
          var indicator = document.getElementById('loading-indicator');
          if (indicator) {
            indicator.innerHTML = 
              '<div style="text-align: center; padding: 20px;">' +
              '<h2 style="color: #003D6D;">Loading Error</h2>' +
              '<p>The application is taking longer than expected to load.</p>' +
              '<p>Please try:</p>' +
              '<ul style="text-align: left; display: inline-block;">' +
              '<li>Refreshing the page</li>' +
              '<li>Clearing Safari cache (Settings > Safari > Clear History and Website Data)</li>' +
              '<li>Checking your internet connection</li>' +
              '</ul>' +
              '<button onclick="location.reload()" style="margin-top: 20px; padding: 10px 20px; background: #003D6D; color: white; border: none; border-radius: 5px;">Refresh Page</button>' +
              '</div>';
          }
        }
      }
      
      // å¼€å§‹æ£€æŸ¥
      checkInterval = setInterval(checkAppLoaded, 100);
      
      // åŒæ—¶ç›‘å¬ DOMContentLoaded
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(checkAppLoaded, 100);
      });
      
      // ç›‘å¬ load äº‹ä»¶
      window.addEventListener('load', function() {
        setTimeout(checkAppLoaded, 100);
      });
    })();
  </script>
</body>
</html>